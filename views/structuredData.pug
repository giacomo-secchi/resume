-
    const occupations = [];
    const education = [];
    const skills = [];
    const languages = [];
    const articles = []; // Aggiunto array per gli articoli

    // Processa ogni sezione
    (Array.isArray(sections) ? sections : []).forEach(section => {
        if (section.type === "Article") {
            processArticles(section);
            return;
        }
    
        processOrganizations(section);
        processLists(section);
        processLanguages(section);
    });

    function iterate(array, callback) {
        if (!Array.isArray(array)) {
            return;
        }

        array.forEach(item => callback(item));
    }


    /**
    * Processa gli articoli/presentazioni
    */
    function processArticles(section) {

        iterate(section.organizations, org => {
        
            if (!org?.title) return;

            const article = {
                "@type": "Article",
                "headline": org.title,
                "datePublished": org.date?.start
            };

            if (org.name) {
                article.publisher = {
                    "@type": "Organization",
                    "name": org.name
                };
            }

            if (org.description) {
                article.articleBody = org.description;
            }

            if (org.link?.url) {
                article.url = org.link.url;
            }

            articles.push(article);
        });
    }

    function processLanguages(section) {
        iterate(section.languages, language => {
            if (!language?.name) return;
            languages.push(language.code);
        });
    }

    /**
    * Processa le organizzazioni dalla sezione
    */
    function processOrganizations(section) {

        iterate(section.organizations, organization => {
            if (!organization?.name) return;

            if (organization.type) {
                processEducationalOrganization(organization);
            } else {
                processEmployeeRole(organization);
            }
        });
    }

    /**
    * Crea e aggiunge un'organizzazione educativa
    */
    function processEducationalOrganization(org) {
        const educationalOrg = {
            "@type": "EducationalOrganization",
            "name": org.name
        };

        if (org.address) {
            educationalOrg.address = createPostalAddress(org.address);
        }

        education.push(educationalOrg);
    }

    /**
    * Crea e aggiunge un ruolo lavorativo
    */
    function processEmployeeRole(org) {
        const employeeRole = {
            "@type": "EmployeeRole",
            "roleName": org.title || "",
            "startDate": org.date?.start,
            "endDate": org.date?.end,
            "name": org.name
        };

        occupations.push(employeeRole);
    }

    /**
    * Crea un indirizzo postale strutturato
    */
    function createPostalAddress(address) {
        const postalAddress = { "@type": "PostalAddress" };
        
        const addressFields = {
            streetAddress: address.streetAddress,
            addressLocality: address.addressLocality,
            addressRegion: address.addressRegion,
            postalCode: address.postalCode,
            addressCountry: address.addressCountry
        };

        Object.entries(addressFields).forEach(([key, value]) => {
            if (value) postalAddress[key] = value;
        });

        return postalAddress;
    }

    /**
    * Processa liste di skills
    */
    function processLists(section) {
        
        iterate(section.lists, list => {

            if (!Array.isArray(list)) return;

            list.forEach(item => {
                if (!item) return;
                skills.push(item);
            });
        });
    }

    const schemaData = {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Giacomo Secchi",
        "jobTitle": "Web Developer / Ecommerce Specialist",
        "url": "https://giacomosecchi.com",
        "sameAs": [
            "https://giacomosecchi.com/portfolio",
            "https://github.com/giacomo-secchi",
            "https://www.linkedin.com/in/giacomosecchi/"
        ],
        "image": "https://www.gravatar.com/avatar/cacd939ed4fbbea7e739d737e3411dc3",   
        "address": {
            "@type": "PostalAddress",
            "addressLocality": "Modena",
            "postalCode": "41121",
            "addressCountry": "IT"
        },
        "telephone": "+393407119634",
        "email": "info@giacomosecchi.com",
        "hasOccupation": occupations,
        "alumniOf": education,
        "skills": skills,
        "knowsLanguage": languages,
        "author": articles
    }

script(type="application/ld+json").
    !{JSON.stringify(schemaData, null, 2)}
